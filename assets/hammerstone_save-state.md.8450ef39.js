import{_ as e,o as a,c as t,U as l}from"./chunks/framework.1eef7d9b.js";const v=JSON.parse('{"title":"Save State","description":"","frontmatter":{},"headers":[],"relativePath":"hammerstone/save-state.md","filePath":"hammerstone/save-state.md","lastUpdated":1688236295000}'),o={name:"hammerstone/save-state.md"},s=l('<h1 id="save-state" tabindex="-1">Save State <a class="header-anchor" href="#save-state" aria-label="Permalink to &quot;Save State&quot;">​</a></h1><p>The save-game system in sapiens is very complex, with lots of cross-thread communication and different ways to save data (runtime only, server only, tribe only, etc). This module makes this much easier, by providing you a one-file API for accessing game-state variables, from any thread. These variables will be saved to disk, and will be available next play-through.</p><h3 id="including" tabindex="-1">Including <a class="header-anchor" href="#including" aria-label="Permalink to &quot;Including&quot;">​</a></h3><div class="language-lua"><button title="Copy Code" class="copy"></button><span class="lang">lua</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">local</span><span style="color:#A6ACCD;"> saveState </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">mjrequire</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hammerstone/state/saveState</span><span style="color:#89DDFF;">&quot;</span></span></code></pre></div><h3 id="example" tabindex="-1">Example <a class="header-anchor" href="#example" aria-label="Permalink to &quot;Example&quot;">​</a></h3><p>A good example is the &#39;creative mode&#39; mod, which has a couple of check-boxes to toggle things like &#39;instant build&#39;. To persist the state of the checkboxes between runs, the save-state system is used.</p><h1 id="api" tabindex="-1">API <a class="header-anchor" href="#api" aria-label="Permalink to &quot;API&quot;">​</a></h1><h2 id="a-note-on-threads" tabindex="-1">A Note on Threads <a class="header-anchor" href="#a-note-on-threads" aria-label="Permalink to &quot;A Note on Threads&quot;">​</a></h2><p>Hammerstone provides a frankly magical abstraction here. The save-state system is available on any thread, from any location. The data-ferrying will be handled for you. This system works by intercepting which thread the call originated from, and then modifying the implementation, based on that. For this to work, the signatures of the functions include a table.</p><p>For example, if you&#39;re calling something on the <em>server</em>, you&#39;re responsible for passing in the client-ID of the client that you&#39;re creating a save value for. If you&#39;re calling on the client, this is not needed, since the client ID is known.</p><h2 id="functions" tabindex="-1">Functions <a class="header-anchor" href="#functions" aria-label="Permalink to &quot;Functions&quot;">​</a></h2><p>Please see the file yourself for in-depth lua-doc style comments and explanations.</p><h3 id="save-state-main" tabindex="-1">Save State (main) <a class="header-anchor" href="#save-state-main" aria-label="Permalink to &quot;Save State (main)&quot;">​</a></h3><ul><li><code>saveState:setValue(key, value, paramTable)</code></li><li><code>saveState:getValue(key, paramTable)</code></li><li><code>saveState:getValueClient(key, defaultOrNil)</code></li><li><code>saveState:getValueServer(key, clientID, defaultOrNil)</code></li><li><code>saveState:setValueServer(key, value, clientID)</code></li></ul><h3 id="utilities" tabindex="-1">Utilities <a class="header-anchor" href="#utilities" aria-label="Permalink to &quot;Utilities&quot;">​</a></h3><ul><li><code>saveState:resolveClientID(paramTable)</code></li><li><code>saveState:resolveClientID(paramTable)</code></li></ul><h3 id="world-state-old" tabindex="-1">World State (old) <a class="header-anchor" href="#world-state-old" aria-label="Permalink to &quot;World State (old)&quot;">​</a></h3><ul><li><code>saveState:getWorldValue(key, --[[optional]] default)</code></li><li><code>saveState:getWorldValueFromServer(clientID, key)</code></li><li><code>saveState:setWorldValue(key, value)</code></li></ul>',18),i=[s];function n(r,d,c,h,u,p){return a(),t("div",null,i)}const f=e(o,[["render",n]]);export{v as __pageData,f as default};
